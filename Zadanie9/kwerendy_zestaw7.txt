1.

SELECT FIRST_NAME, LAST_NAME, pensja, RANK() OVER (ORDER BY pensja DESC) AS ranking_pensji FROM EMPLOYEE;

2.
SELECT FIRST_NAME, LAST_NAME, pensja, SUM(pensja) OVER () AS suma_wszystkich_pensji FROM EMPLOYEE;

3.
SELECT e.LAST_NAME, p.PRODUCT_NAME, (op.AMOUNT * op.SELL_PRICE) AS wartosc_pozycji, SUM(op.AMOUNT * op.SELL_PRICE) OVER (PARTITION BY o.EMPLOYEE_ID) AS suma_sprzedazy_pracownika, RANK() OVER (ORDER BY (op.AMOUNT * op.SELL_PRICE) DESC) AS ranking_globalny FROM ORDER_POSITION op JOIN `ORDER` o ON op.ORDER_ID = o.ORDER_ID JOIN EMPLOYEE e ON o.EMPLOYEE_ID = e.EMPLOYEE_NAME JOIN PRODUCT p ON op.PRODUCT_ID = p.PRODUCT_ID;

4.
SELECT e.LAST_NAME, p.PRODUCT_NAME, op.SELL_PRICE, COUNT(*) OVER (PARTITION BY op.PRODUCT_ID, o.ORDER_DATE) AS liczba_transakcji_dnia, SUM(op.AMOUNT * op.SELL_PRICE) OVER (PARTITION BY op.PRODUCT_ID, o.ORDER_DATE) AS suma_dnia, LAG(op.SELL_PRICE) OVER (PARTITION BY op.PRODUCT_ID ORDER BY o.ORDER_DATE) AS poprzednia_cena, LEAD(op.SELL_PRICE) OVER (PARTITION BY op.PRODUCT_ID ORDER BY o.ORDER_DATE) AS nastepna_cena FROM ORDER_POSITION op JOIN `ORDER` o ON op.ORDER_ID = o.ORDER_ID JOIN EMPLOYEE e ON o.EMPLOYEE_ID = e.EMPLOYEE_NAME JOIN PRODUCT p ON op.PRODUCT_ID = p.PRODUCT_ID;

5.
SELECT p.PRODUCT_NAME, op.SELL_PRICE, o.ORDER_DATE, SUM(op.AMOUNT * op.SELL_PRICE) OVER (PARTITION BY MONTH(o.ORDER_DATE)) AS suma_miesieczna_calkowita, SUM(op.AMOUNT * op.SELL_PRICE) OVER (PARTITION BY MONTH(o.ORDER_DATE) ORDER BY o.ORDER_DATE) AS suma_miesieczna_rosnaca FROM ORDER_POSITION op JOIN `ORDER` o ON op.ORDER_ID = o.ORDER_ID JOIN PRODUCT p ON op.PRODUCT_ID = p.PRODUCT_ID;

6.


7.

SELECT c.CATEGORY_NAME, p.PRODUCT_NAME, p.PURCHASE_PRICE, MIN(p.PURCHASE_PRICE) OVER (PARTITION BY p.CATEGORY_ID) AS min_cena_w_kat, MAX(p.PURCHASE_PRICE) OVER (PARTITION BY p.CATEGORY_ID) AS max_cena_w_kat, (MAX(p.PURCHASE_PRICE) OVER (PARTITION BY p.CATEGORY_ID) - MIN(p.PURCHASE_PRICE) OVER (PARTITION BY p.CATEGORY_ID)) AS roznica_cen FROM PRODUCT p JOIN CATEGORY c ON p.CATEGORY_ID = c.CATEGORY_ID;

8.

SELECT p.PRODUCT_NAME, o.ORDER_DATE, op.SELL_PRICE, AVG(op.SELL_PRICE) OVER (PARTITION BY op.PRODUCT_ID ORDER BY o.ORDER_DATE ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS srednia_kroczaca FROM ORDER_POSITION op JOIN `ORDER` o ON op.ORDER_ID = o.ORDER_ID JOIN PRODUCT p ON op.PRODUCT_ID = p.PRODUCT_ID;

9.

SELECT p.PRODUCT_NAME, c.CATEGORY_NAME, p.PURCHASE_PRICE, RANK() OVER (PARTITION BY p.CATEGORY_ID ORDER BY p.PURCHASE_PRICE) AS ranking, ROW_NUMBER() OVER (PARTITION BY p.CATEGORY_ID ORDER BY p.PURCHASE_PRICE) AS numer_wiersza, DENSE_RANK() OVER (PARTITION BY p.CATEGORY_ID ORDER BY p.PURCHASE_PRICE) AS ranking_gesty FROM PRODUCT p JOIN CATEGORY c ON p.CATEGORY_ID = c.CATEGORY_ID;

10.


11.

SELECT DISTINCT e.FIRST_NAME, e.LAST_NAME, j.POSITION_NAME FROM EMPLOYEE e JOIN JOB_POSITION j ON e.JOB_POSITION_ID = j.JOB_POSITION_ID JOIN `ORDER` o ON e.EMPLOYEE_NAME = o.EMPLOYEE_ID;
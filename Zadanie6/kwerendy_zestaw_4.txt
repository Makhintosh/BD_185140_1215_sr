Zad 1.

1.
SELECT AVG(pensja) AS 'srednia pensja' FROM EMPLOYEE;

2.
SELECT AVG(pensja) AS 'SREDNIA PENSJA', JOB_POSITION_ID, COUNT(*) AS 'ILE PRACOWNIKOW' FROM EMPLOYEE GROUP BY
JOB_POSITION_ID;

3.
SELECT DEPARTMENT_ID, AVG(YEAR(BIRTH_DATE)) AS 'SREDNI WIEK' FROM EMPLOYEE GROUP BY DEPARTMENT_ID;

Zad 2.

1.
SELECT DEPARTMENT_ID, SUM(pensja) AS 'LACZNA PENSJA' FROM EMPLOYEE GROUP BY DEPARTMENT_ID ORDER BY SUM(pensja) DESC;

2.
SELECT JOB_POSITION_ID, AVG(pensja) AS 'SREDNIA PENSJA', COUNT(JOB_POSITION_ID) AS 'ILOSC PRACOWNIKOW' FROM EMPLOYEE GROUP BY JOB_POSITION_ID HAVING COUNT(JOB_POSITION_ID) >= 3 AND 
AVG(pensja) > 3000;

3.
SELECT COUNT(DISTINCT pensja) AS 'ILOSC ROZNYCH PENSJI', DEPARTMENT_ID FROM EMPLOYEE GROUP BY DEPARTMENT_ID HAVING COUNT(*) > 4 ORDER BY COUNT(DISTINCT pensja) ASC;

Zad 3.

1.
CREATE TABLE DEPARTMENT AS SELECT * FROM company_2025.DEPARTMENT;
CREATE TABLE JOB_POSITION AS SELECT * FROM company_2025.JOB_POSITION;

2.
SELECT DEPARTMENT.DEPARTMENT_NAME, COUNT(EMPLOYEE.DEPARTMENT_ID) FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID GROUP BY DEPARTMENT.DEPARTMENT_NAME;

3.
SELECT DEPARTMENT.DEPARTMENT_NAME, EMPLOYEE.FIRST_NAME, EMPLOYEE.LAST_NAME FROM DEPARTMENT JOIN EMPLOYEE ON DEPARTMENT.DEPARTMENT_ID = EMPLOYEE.DEPARTMENT_ID ORDER BY DEPARTMENT.DEPARTMENT_NAME DESC;

Zad 4.

1.
SELECT YEAR(EMPLOYEE.BIRTH_DATE) AS 'DATA URODZENIA', EMPLOYEE.LAST_NAME, DEPARTMENT.DEPARTMENT_NAME FROM EMPLOYEE NATURAL JOIN DEPARTMENT WHERE YEAR(EMPLOYEE.BIRTH_DATE) BETWEEN 1900 AND 2000 ORDER BY DEPARTMENT.DEPARTMENT_NAME DESC;

2.
SELECT EMPLOYEE.FIRST_NAME, EMPLOYEE.LAST_NAME, EMPLOYEE.BIRTH_DATE, DEPARTMENT.DEPARTMENT_NAME FROM EMPLOYEE NATURAL JOIN DEPARTMENT WHERE DEPARTMENT.DEPARTMENT_NAME = 'Magazyn' ORDER BY EMPLOYEE.BIRTH_DATE DESC LIMIT 5;

3.
SELECT CONCAT(C1.SHORT_NAME, ' - ', C2.SHORT_NAME) FROM CLIENT AS C1 JOIN CLIENT AS C2 ON C1.CLIENT_ID = C2.CLIENT_ID + 5;

Zad 5.

1.
SELECT JOB_POSITION.POSITION_NAME, AVG(EMPLOYEE.pensja), COUNT(EMPLOYEE.JOB_POSITION_ID) AS 'LICZBA PRACOWNIKOW' FROM JOB_POSITION JOIN EMPLOYEE ON JOB_POSITION.JOB_POSITION_ID = EMPLOYEE.JOB_POSITION_ID WHERE JOB_POSITION.POSITION_NAME NOT IN ('IT', 'HR') GROUP BY JOB_POSITION.POSITION_NAME HAVING COUNT(*) > 3;

2.
SELECT JOB_POSITION.POSITION_NAME, EMPLOYEE.FIRST_NAME, EMPLOYEE.LAST_NAME, EMPLOYEE.BIRTH_DATE, DEPARTMENT.DEPARTMENT_NAMEFROM EMPLOYEE
JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_IDJOIN JOB_POSITION ON JOB_POSITION.JOB_POSITION_ID = EMPLOYEE.JOB_POSITION_ID
WHERE EMPLOYEE.BIRTH_DATE = (SELECT MAX(BIRTH_DATE) FROM EMPLOYEE WHERE JOB_POSITION_ID = JOB_POSITION.JOB_POSITION_ID);

SELECT JOB_POSITION.POSITION_NAME, EMPLOYEE.FIRST_NAME, EMPLOYEE.LAST_NAME, EMPLOYEE.BIRTH_DATE, DEPARTMENT.DEPARTMENT_NAMEFROM EMPLOYEE
JOIN DEPARTMENT ON EMPLOYEE.DEPARTMENT_ID = DEPARTMENT.DEPARTMENT_IDJOIN JOB_POSITION ON JOB_POSITION.JOB_POSITION_ID = EMPLOYEE.JOB_POSITION_ID
WHERE EMPLOYEE.BIRTH_DATE = (SELECT MIN(BIRTH_DATE) FROM EMPLOYEE WHERE JOB_POSITION_ID = JOB_POSITION.JOB_POSITION_ID);

